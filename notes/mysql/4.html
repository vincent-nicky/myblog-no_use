<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第6章_多表查询 | No pains, no gains</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/logo.png">
    <link rel="manifest" href="/myblog/manifest.json">
    <link rel="apple-touch-icon" href="/myblog/icons/LatteAndCat.png">
    <link rel="mask-icon" href="/myblog/icons/LatteAndCat.svg" color="#FF66CC">
    <meta name="description" content="温绍杰的博客">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="theme-color" content="#FF66CC">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/LatteAndCat.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.4123baaf.css" as="style"><link rel="preload" href="/myblog/assets/js/app.72a6aef1.js" as="script"><link rel="preload" href="/myblog/assets/js/3.db593f0c.js" as="script"><link rel="preload" href="/myblog/assets/js/1.2743d3a9.js" as="script"><link rel="preload" href="/myblog/assets/js/26.51c97df9.js" as="script"><link rel="preload" href="/myblog/assets/js/9.addaf399.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.6a0c6a60.js"><link rel="prefetch" href="/myblog/assets/js/11.8eb9cc9e.js"><link rel="prefetch" href="/myblog/assets/js/12.efd9e855.js"><link rel="prefetch" href="/myblog/assets/js/13.77f4b0be.js"><link rel="prefetch" href="/myblog/assets/js/14.3499ba66.js"><link rel="prefetch" href="/myblog/assets/js/15.2b9b9781.js"><link rel="prefetch" href="/myblog/assets/js/16.00aca14b.js"><link rel="prefetch" href="/myblog/assets/js/17.165bd8bf.js"><link rel="prefetch" href="/myblog/assets/js/18.6ddccc86.js"><link rel="prefetch" href="/myblog/assets/js/19.9c62ef56.js"><link rel="prefetch" href="/myblog/assets/js/20.af1ed9e5.js"><link rel="prefetch" href="/myblog/assets/js/21.f8a2759f.js"><link rel="prefetch" href="/myblog/assets/js/22.f4c3545d.js"><link rel="prefetch" href="/myblog/assets/js/23.fb4c1115.js"><link rel="prefetch" href="/myblog/assets/js/24.e8659f12.js"><link rel="prefetch" href="/myblog/assets/js/25.4401edbf.js"><link rel="prefetch" href="/myblog/assets/js/27.20031cb8.js"><link rel="prefetch" href="/myblog/assets/js/28.a6d46429.js"><link rel="prefetch" href="/myblog/assets/js/29.b5736a4f.js"><link rel="prefetch" href="/myblog/assets/js/30.1fd31b24.js"><link rel="prefetch" href="/myblog/assets/js/31.2518b44f.js"><link rel="prefetch" href="/myblog/assets/js/32.8e755a32.js"><link rel="prefetch" href="/myblog/assets/js/33.710a7066.js"><link rel="prefetch" href="/myblog/assets/js/34.63736891.js"><link rel="prefetch" href="/myblog/assets/js/35.cac4c0d5.js"><link rel="prefetch" href="/myblog/assets/js/36.35337087.js"><link rel="prefetch" href="/myblog/assets/js/37.8673f748.js"><link rel="prefetch" href="/myblog/assets/js/38.b33ac22e.js"><link rel="prefetch" href="/myblog/assets/js/4.282e8e37.js"><link rel="prefetch" href="/myblog/assets/js/5.4341e77e.js"><link rel="prefetch" href="/myblog/assets/js/6.b7ba3f57.js"><link rel="prefetch" href="/myblog/assets/js/7.cf7eb837.js"><link rel="prefetch" href="/myblog/assets/js/8.821bd667.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.4123baaf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>No pains, no gains</h3> <p class="description" data-v-59e6cb88>温绍杰的博客</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>温绍杰</span>
          
        <!---->
        2022
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/avatar.jpg" alt="No pains, no gains" class="logo"> <span class="site-name">No pains, no gains</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><a href="/myblog/notes/" class="nav-link router-link-active"><i class="iconfont reco-document"></i>
  笔记
</a></div><div class="nav-item"><a href="/myblog/log/" class="nav-link"><i class="iconfont reco-blog"></i>
  开发日志
</a></div><div class="nav-item"><a href="/myblog/life/" class="nav-link"><i class="iconfont reco-account"></i>
  生活
</a></div><div class="nav-item"><a href="/myblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><a href="/myblog/have-fun/111.html" class="nav-link"><i></i>
  调整呼吸
</a></div><div class="nav-item"><a href="/myblog/have-fun/222.html" class="nav-link"><i></i>
  空调房
</a></div><div class="nav-item"><a href="https://github.com/Charon-33" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/avatar.jpg" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    温绍杰
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>23</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>5</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><a href="/myblog/notes/" class="nav-link router-link-active"><i class="iconfont reco-document"></i>
  笔记
</a></div><div class="nav-item"><a href="/myblog/log/" class="nav-link"><i class="iconfont reco-blog"></i>
  开发日志
</a></div><div class="nav-item"><a href="/myblog/life/" class="nav-link"><i class="iconfont reco-account"></i>
  生活
</a></div><div class="nav-item"><a href="/myblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><a href="/myblog/have-fun/111.html" class="nav-link"><i></i>
  调整呼吸
</a></div><div class="nav-item"><a href="/myblog/have-fun/222.html" class="nav-link"><i></i>
  空调房
</a></div><div class="nav-item"><a href="https://github.com/Charon-33" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <ul class="sidebar-links"><li><a href="/myblog/notes/" aria-current="page" class="sidebar-link">学习笔记</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>😶‍🌫️vue全解（待续）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>🫡Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/notes/java/10.html" class="sidebar-link">第10章 面向对象编程(高级部分)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>🤓mysql基础篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/notes/mysql/1.html" class="sidebar-link">第3章_基本的SELECT语句</a></li><li><a href="/myblog/notes/mysql/2.html" class="sidebar-link">第4章_运算符</a></li><li><a href="/myblog/notes/mysql/3.html" class="sidebar-link">第5章_排序与分页</a></li><li><a href="/myblog/notes/mysql/4.html" aria-current="page" class="active sidebar-link">第6章_多表查询</a></li><li><a href="/myblog/notes/mysql/5.html" class="sidebar-link">第7章_单行函数</a></li><li><a href="/myblog/notes/mysql/6.html" class="sidebar-link">第8章_聚合函数</a></li><li><a href="/myblog/notes/mysql/7.html" class="sidebar-link">第9章_子查询</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>第6章_多表查询</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>温绍杰</span>
          
        <!---->
        2022
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">第6章_多表查询</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>温绍杰</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2022/11/5</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>mysql笔记</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="上一章练习答案"><a href="#上一章练习答案" class="header-anchor">#</a> 上一章练习答案</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1. 查询员工的姓名和部门号和年薪，按年薪降序,按姓名升序显示 </span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_id<span class="token punctuation">,</span>salary <span class="token operator">*</span> <span class="token number">12</span> annual_salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> annual_salary <span class="token keyword">DESC</span><span class="token punctuation">,</span>last_name <span class="token keyword">ASC</span><span class="token punctuation">;</span>

<span class="token comment">#2. 选择工资不在 8000 到 17000 的员工的姓名和工资，按工资降序，显示第21到40位置的数据 </span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> salary <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token number">8000</span> <span class="token operator">AND</span> <span class="token number">17000</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">;</span>

<span class="token comment">#3. 查询邮箱中包含 e 的员工信息，并先按邮箱的字节数降序，再按部门号升序</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>email<span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> employees
<span class="token comment">#where email like '%e%'</span>
<span class="token keyword">WHERE</span> email <span class="token operator">REGEXP</span> <span class="token string">'[e]'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> LENGTH<span class="token punctuation">(</span>email<span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">,</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="多表查询"><a href="#多表查询" class="header-anchor">#</a> 多表查询</h2> <p>多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。</p> <p>前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。</p> <h2 id="_1-一个案例引发的多表连接"><a href="#_1-一个案例引发的多表连接" class="header-anchor">#</a> 1. 一个案例引发的多表连接</h2> <h3 id="_1-1-案例说明"><a href="#_1-1-案例说明" class="header-anchor">#</a> 1.1 案例说明</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#1. 熟悉常见的几个表</span>
<span class="token keyword">DESC</span> employees<span class="token punctuation">;</span>
<span class="token keyword">DESC</span> departments<span class="token punctuation">;</span>
<span class="token keyword">DESC</span> locations<span class="token punctuation">;</span>

<span class="token comment">#查询员工名为'Abel'的人在哪个城市工作？</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> departments
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> locations 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554974984600.png" alt="1554974984600"></p> <p>从多个表中获取数据：</p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554975020388.png" alt="1554975020388"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#案例：查询员工的姓名及其部门名称</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> department_name
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span> departments<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554975097631.png" alt="1554975097631"></p> <p>查询结果：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">+</span><span class="token comment">-----------+----------------------+</span>
<span class="token operator">|</span> last_name <span class="token operator">|</span> department_name      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+----------------------+</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Administration       <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Marketing            <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Purchasing           <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Human Resources      <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Shipping             <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> IT                   <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> <span class="token keyword">Public</span> Relations     <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Sales                <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Executive            <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Finance              <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Accounting           <span class="token operator">|</span>
<span class="token operator">|</span> King      <span class="token operator">|</span> Treasury             <span class="token operator">|</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">|</span> Gietz     <span class="token operator">|</span> IT Support           <span class="token operator">|</span>
<span class="token operator">|</span> Gietz     <span class="token operator">|</span> NOC                  <span class="token operator">|</span>
<span class="token operator">|</span> Gietz     <span class="token operator">|</span> IT Helpdesk          <span class="token operator">|</span>
<span class="token operator">|</span> Gietz     <span class="token operator">|</span> Government Sales     <span class="token operator">|</span>
<span class="token operator">|</span> Gietz     <span class="token operator">|</span> Retail Sales         <span class="token operator">|</span>
<span class="token operator">|</span> Gietz     <span class="token operator">|</span> Recruiting           <span class="token operator">|</span>
<span class="token operator">|</span> Gietz     <span class="token operator">|</span> Payroll              <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+----------------------+</span>
<span class="token number">2889</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>分析错误情况：</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
<span class="token comment">#输出107行</span>

<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token keyword">FROM</span> departments<span class="token punctuation">;</span>
<span class="token comment">#输出27行</span>

<span class="token keyword">SELECT</span> <span class="token number">107</span><span class="token operator">*</span><span class="token number">27</span> <span class="token keyword">FROM</span> dual<span class="token punctuation">;</span>
<span class="token comment"># 2889</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>我们把上述多表查询中出现的问题称为：笛卡尔积的错误。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#2. 出现笛卡尔积的错误</span>
<span class="token comment">#错误的原因：缺少了多表的连接条件</span>

<span class="token comment">#错误的实现方式：每个员工都与每个部门匹配了一遍。</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments<span class="token punctuation">;</span>  <span class="token comment">#查询出2889条记录</span>

<span class="token comment">#错误的方式</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> departments<span class="token punctuation">;</span><span class="token comment">#查询出2889条记录</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_1-2-笛卡尔积-或交叉连接-的理解"><a href="#_1-2-笛卡尔积-或交叉连接-的理解" class="header-anchor">#</a> 1.2 笛卡尔积（或交叉连接）的理解</h3> <p>笛卡尔乘积是一个数学运算。假设我有两个集合 X 和 Y，<font color="orange">那么 X 和 Y 的笛卡尔积就是 X 和 Y 的所有可能组合</font>，也就是第一个对象来自于 X，第二个对象来自于 Y 的所有可能。<font color="orange">组合的个数即为两个集合中元素个数的乘积数。</font></p> <img src="https://images0.cnblogs.com/i/595518/201403/302046364841977.jpg" alt="img" style="zoom:80%;"> <p><code>SQL92</code>中，笛卡尔积也称为<font color="orange">交叉连接</font>，英文是<font color="orange"> CROSS JOIN</font>。在 SQL99 中也是使用 CROSS JOIN表示交叉连接。它的作用就是可以把任意表进行连接，即使这两张表不相关。在MySQL中如下情况会出现笛卡尔积：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#查询员工姓名和所在部门名称</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name <span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name <span class="token keyword">FROM</span> employees <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> departments<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name <span class="token keyword">FROM</span> employees <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name <span class="token keyword">FROM</span> employees <span class="token keyword">JOIN</span> departments<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_1-3-案例分析与问题解决"><a href="#_1-3-案例分析与问题解决" class="header-anchor">#</a> 1.3 案例分析与问题解决</h3> <ul><li><p><strong>笛卡尔积的错误会在下面条件下产生</strong>：</p> <ul><li>省略多个表的连接条件（或关联条件）</li> <li>连接条件（或关联条件）无效</li> <li>所有表中的所有行互相连接</li></ul></li> <li><p>为了避免笛卡尔积， 可以<strong>在 WHERE 加入有效的连接条件。</strong></p></li> <li><p>加入连接条件后，查询语法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>	table1<span class="token punctuation">.</span><span class="token keyword">column</span><span class="token punctuation">,</span> table2<span class="token punctuation">.</span><span class="token keyword">column</span>
<span class="token keyword">FROM</span>	table1<span class="token punctuation">,</span> table2
<span class="token keyword">WHERE</span>	table1<span class="token punctuation">.</span>column1 <span class="token operator">=</span> table2<span class="token punctuation">.</span>column2<span class="token punctuation">;</span>  <span class="token comment">#连接条件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>在 WHERE子句中写入连接条件。</strong></li></ul></li> <li><p>正确写法：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#案例：查询员工的姓名及其部门名称</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> department_name
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span> departments
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><strong>在表中有相同列时，在列名之前加上表名前缀。</strong></p></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#4. 如果查询语句中出现了多个表中都存在的字段，则必须指明此字段所在的表。</span>
<span class="token keyword">SELECT</span> employees<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>departments<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>employees<span class="token punctuation">.</span>department_id
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_2-多表查询分类讲解"><a href="#_2-多表查询分类讲解" class="header-anchor">#</a> 2. 多表查询分类讲解</h2> <h3 id="分类1-等值连接-vs-非等值连接"><a href="#分类1-等值连接-vs-非等值连接" class="header-anchor">#</a> 分类1：等值连接 vs 非等值连接</h3> <h4 id="等值连接"><a href="#等值连接" class="header-anchor">#</a> 等值连接</h4> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554975496900.png" alt="1554975496900"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employees<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> employees<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> 
       employees<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>
       departments<span class="token punctuation">.</span>location_id
<span class="token keyword">FROM</span>   employees<span class="token punctuation">,</span> departments
<span class="token keyword">WHERE</span>  employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554975522600.png" alt="1554975522600"></p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554975526339.png" alt="1554975526339"></p> <p><strong>拓展1：多个连接条件与 AND 操作符</strong></p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554975606231.png" alt="1554975606231"></p> <p><strong>拓展2：区分重复的列名</strong></p> <ul><li><strong>多个表中有相同列时，必须在列名之前加上表名前缀。</strong></li> <li>在不同表中具有相同列名的列可以用<code>表名</code>加以区分。</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employees<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> departments<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>employees<span class="token punctuation">.</span>department_id
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span> departments
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>拓展3：表的别名</strong></p> <ul><li><p>使用别名可以简化查询。</p></li> <li><p>列名前使用表名前缀可以提高查询效率。</p></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>
       d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>location_id
<span class="token keyword">FROM</span>   employees e <span class="token punctuation">,</span> departments d
<span class="token keyword">WHERE</span>  e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>需要注意的是，如果我们使用了表的别名，在查询字段中、过滤条件中就只能使用别名进行代替，不能使用原有的表名，否则就会报错。</p></blockquote> <blockquote><p><code>阿里开发规范</code>：</p> <p>【<code>强制</code>】对于数据库中表记录的查询和变更，只要涉及多个表，都需要在列名前加表的别名（或 表名）进行限定。</p> <p><code>说明</code>：对多表进行查询记录、更新记录、删除记录时，如果对操作列没有限定表的别名（或表名），并且操作列在多个表中存在时，就会抛异常。</p> <p><code>正例</code>：select t1.name from table_first as t1 , table_second as t2 where t1.id=t2.id;</p> <p><code>反例</code>：在某业务中，由于多表关联查询语句没有加表的别名（或表名）的限制，正常运行两年后，最近在 某个表中增加一个同名字段，在预发布环境做数据库变更后，线上查询语句出现出 1052 异常：Column  'name' in field list is ambiguous。</p></blockquote> <p><strong>拓展4：连接多个表</strong></p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978354431.png" alt="1554978354431"></p> <p><strong>总结：连接 n个表,至少需要n-1个连接条件</strong>。比如，连接三个表，至少需要两个连接条件。</p> <p>练习：查询出公司员工的 last_name,department_name, city</p> <h4 id="非等值连接"><a href="#非等值连接" class="header-anchor">#</a> 非等值连接</h4> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978442447.png" alt="1554978442447"></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> job_grades<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>j<span class="token punctuation">.</span>grade_level
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>job_grades j
<span class="token comment">#where e.`salary` between j.`lowest_sal` and j.`highest_sal`;</span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">&gt;=</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>lowest_sal<span class="token punctuation">`</span></span> <span class="token operator">AND</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">&lt;=</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>highest_sal<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978477013.png" alt="1554978477013"></p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978482652.png" alt="1554978482652"></p> <h3 id="分类2-自连接-vs-非自连接"><a href="#分类2-自连接-vs-非自连接" class="header-anchor">#</a> 分类2：自连接 vs 非自连接</h3> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978514321.png" alt="1554978514321"></p> <ul><li>当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义。然后两个表再进行内连接，外连接等查询。</li></ul> <p><strong>题目：查询employees表，返回“Xxx  works for Xxx”</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#自连接的例子：</span>
<span class="token comment">#练习：查询员工id,员工姓名及其管理者的id和姓名</span>
<span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name
<span class="token keyword">FROM</span> employees emp <span class="token punctuation">,</span>employees mgr
<span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> mgr<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment"># 查询employees表，返回“Xxx  works for Xxx”</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>worker<span class="token punctuation">.</span>last_name <span class="token punctuation">,</span><span class="token string">' works for '</span> 
       <span class="token punctuation">,</span> manager<span class="token punctuation">.</span>last_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span>   employees worker<span class="token punctuation">,</span> employees manager
<span class="token keyword">WHERE</span>  worker<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> manager<span class="token punctuation">.</span>employee_id <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978684947.png" alt="1554978684947"></p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978690764.png" alt="1554978690764"></p> <p>练习：查询出last_name为 ‘Chen’ 的员工的 manager 的信息。</p> <h3 id="分类3-内连接-vs-外连接"><a href="#分类3-内连接-vs-外连接" class="header-anchor">#</a> 分类3：内连接 vs 外连接</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 内连接：合并具有同一列的两个以上的表的行, 结果集中不包含一个表与另一个表不匹配的行</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>  <span class="token comment">#只有106条记录</span>

<span class="token comment"># 外连接：合并具有同一列的两个以上的表的行, 结果集中除了包含一个表与另一个表匹配的行之外，还查询到了左表 或 右表中不匹配的行。</span>

<span class="token comment"># 要结合集合的概念</span>
<span class="token comment"># 外连接的分类：左外连接、右外连接、满外连接</span>

<span class="token comment"># 左外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回左表中不满足条件的行，这种连接称为左外连接。</span>
<span class="token comment"># 右外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回右表中不满足条件的行，这种连接称为右外连接。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>除了查询满足条件的记录以外，外连接还可以查询某一方不满足条件的记录。</p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554978955659.png" alt="1554978955659"></p> <ul><li><p>内连接: 合并具有同一列的两个以上的表的行, <strong>结果集中不包含一个表与另一个表不匹配的行</strong></p></li> <li><p>外连接: 两个表在连接过程中除了返回满足连接条件的行以外<strong>还返回左（或右）表中不满足条件的行</strong> <strong>，这种连接称为左（或右） 外连接</strong>。没有匹配的行时, 结果表中相应的列为空(NULL)。</p></li> <li><p>如果是左外连接，则连接条件中左边的表也称为<code>主表</code>，右边的表称为<code>从表</code>。</p> <p>如果是右外连接，则连接条件中右边的表也称为<code>主表</code>，左边的表称为<code>从表</code>。</p></li></ul> <h4 id="sql92-使用-创建连接"><a href="#sql92-使用-创建连接" class="header-anchor">#</a> <code>SQL92</code>：使用(+)创建连接</h4> <ul><li><p>在 SQL92 中采用（+）代表从表所在的位置。即左或右外连接中，(+) 表示哪个是从表。</p></li> <li><p><font color="orange">Oracle 对 SQL92 支持较好，而 MySQL 则不支持 SQL92 的外连接</font>。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#左右外连接可以理解成两条腿，左外连接是左腿长，右腿短，想要走路，右腿要加长，右外连接同理</span>

<span class="token comment">#左外连接</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees <span class="token punctuation">,</span>departments
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#右外连接</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees <span class="token punctuation">,</span>departments
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span> <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>而且在 SQL92 中，只有左外连接和右外连接，没有满（或全）外连接。</p></li></ul> <h2 id="_3-sql99语法实现多表查询"><a href="#_3-sql99语法实现多表查询" class="header-anchor">#</a> 3. <code>SQL99</code>语法实现多表查询</h2> <h3 id="_3-1-基本语法"><a href="#_3-1-基本语法" class="header-anchor">#</a> 3.1 基本语法</h3> <ul><li><p>使用JOIN...ON子句创建连接的语法结构：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> table1<span class="token punctuation">.</span><span class="token keyword">column</span><span class="token punctuation">,</span> table2<span class="token punctuation">.</span><span class="token keyword">column</span><span class="token punctuation">,</span>table3<span class="token punctuation">.</span><span class="token keyword">column</span>
<span class="token keyword">FROM</span> table1
    <span class="token keyword">JOIN</span> table2 <span class="token keyword">ON</span> table1 和 table2 的连接条件
        <span class="token keyword">JOIN</span> table3 <span class="token keyword">ON</span> table2 和 table3 的连接条件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>它的嵌套逻辑类似我们使用的 FOR 循环：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">for</span> t1 <span class="token operator">in</span> table1:
    <span class="token keyword">for</span> t2 <span class="token operator">in</span> table2:
       <span class="token keyword">if</span> condition1:
           <span class="token keyword">for</span> t3 <span class="token operator">in</span> table3:
              <span class="token keyword">if</span> condition2:
                  output t1 <span class="token operator">+</span> t2 <span class="token operator">+</span> t3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>SQL99 采用的这种嵌套结构非常清爽、层次性更强、可读性更强，即使再多的表进行连接也都清晰可见。如果你采用 SQL92，可读性就会大打折扣。</p></li> <li><p>语法说明：</p> <ul><li><strong>可以使用</strong> <strong>ON</strong> <strong>子句指定额外的连接条件</strong>。</li> <li>这个连接条件是与其它条件分开的。</li> <li><strong>ON</strong> <strong>子句使语句具有更高的易读性</strong>。</li> <li>关键字 JOIN、INNER JOIN、CROSS JOIN 的含义是一样的，都表示内连接</li></ul></li></ul> <h3 id="_3-2-内连接-inner-join-的实现"><a href="#_3-2-内连接-inner-join-的实现" class="header-anchor">#</a> 3.2 内连接(INNER JOIN)的实现</h3> <ul><li>语法：</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 字段列表
<span class="token keyword">FROM</span> A表 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> B表
<span class="token keyword">ON</span> 关联条件
<span class="token keyword">WHERE</span> 等其他子句<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>题目1：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> 
       d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>location_id
<span class="token keyword">FROM</span>   employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span>     <span class="token punctuation">(</span>e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979073996.png" alt="1554979073996"></p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979079395.png" alt="1554979079395"></p> <p>题目2：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> city<span class="token punctuation">,</span> department_name
<span class="token keyword">FROM</span>   employees e 
<span class="token keyword">JOIN</span>   departments d
<span class="token keyword">ON</span>     d<span class="token punctuation">.</span>department_id <span class="token operator">=</span> e<span class="token punctuation">.</span>department_id 
<span class="token keyword">JOIN</span>   locations l
<span class="token keyword">ON</span>     d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979110008.png" alt="1554979110008"></p> <p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979115642.png" alt="1554979115642"></p> <h3 id="_3-3-外连接-outer-join-的实现"><a href="#_3-3-外连接-outer-join-的实现" class="header-anchor">#</a> 3.3 外连接(OUTER JOIN)的实现</h3> <h4 id="_3-3-1-左外连接-left-outer-join"><a href="#_3-3-1-左外连接-left-outer-join" class="header-anchor">#</a> 3.3.1 左外连接(LEFT OUTER JOIN)</h4> <ul><li>语法：</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#实现查询结果是A</span>
<span class="token keyword">SELECT</span> 字段列表
<span class="token keyword">FROM</span> A表 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> B表
<span class="token keyword">ON</span> 关联条件
<span class="token keyword">WHERE</span> 等其他子句<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>举例：</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 有的员工没有所属部门，但仍要显示出来（左腿长，右腿短，右腿加长）</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">FROM</span>   employees e
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span>   <span class="token punctuation">(</span>e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979200961.png" alt="1554979200961"></p> <h4 id="_3-3-2-右外连接-right-outer-join"><a href="#_3-3-2-右外连接-right-outer-join" class="header-anchor">#</a> 3.3.2 右外连接(RIGHT OUTER JOIN)</h4> <ul><li>语法：</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#实现查询结果是B</span>
<span class="token keyword">SELECT</span> 字段列表
<span class="token keyword">FROM</span> A表 <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> B表
<span class="token keyword">ON</span> 关联条件
<span class="token keyword">WHERE</span> 等其他子句<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>举例：</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 有的部门是没有员工的，但仍要显示出来</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name
<span class="token keyword">FROM</span>   employees e
<span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span>    <span class="token punctuation">(</span>e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979243194.png" alt="1554979243194"></p> <blockquote><p>需要注意的是，LEFT JOIN 和 RIGHT JOIN 只存在于 SQL99 及以后的标准中，在 SQL92 中不存在，只能用 (+) 表示。</p></blockquote> <h4 id="_3-3-3-满外连接-full-outer-join"><a href="#_3-3-3-满外连接-full-outer-join" class="header-anchor">#</a> 3.3.3 满外连接(FULL OUTER JOIN)</h4> <ul><li><font color="orange">满外连接的结果 = 左右表匹配的数据 + 左表没有匹配到的数据 + 右表没有匹配到的数据。</font></li> <li>SQL99是支持满外连接的。使用FULL JOIN 或 FULL OUTER JOIN来实现。</li> <li><font color="orange">需要注意的是，MySQL不支持FULL JOIN，但是可以用 LEFT JOIN <strong>UNION</strong> RIGHT join代替。</font></li></ul> <h2 id="_4-union的使用"><a href="#_4-union的使用" class="header-anchor">#</a> 4. UNION的使用</h2> <p><strong>合并查询结果</strong>
利用UNION关键字，可以给出多条SELECT语句，并将它们的结果组合成单个结果集。合并时，两个表对应的列数和数据类型必须相同，并且相互对应。各个SELECT语句之间使用UNION或UNION ALL关键字分隔。</p> <p>语法格式：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table1
<span class="token keyword">UNION</span> <span class="token punctuation">[</span><span class="token keyword">ALL</span><span class="token punctuation">]</span>
<span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>UNION操作符</strong>（满外连接：1+106+16）</p> <img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979317187.png" alt="1554979317187" style="zoom:67%;"> <p><font color="orange">UNION 操作符返回两个查询的结果集的并集，去除重复记录。</font></p> <p><strong>UNION ALL操作符</strong>（中间重复的算了两次：1+106+106+16）</p> <img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979343634.png" alt="1554979343634" style="zoom:67%;"> <p><font color="orange">UNION ALL操作符返回两个查询的结果集的并集。对于两个结果集的重复部分，不去重。</font></p> <blockquote><p><font color="orange">注意：执行UNION ALL语句时所需要的资源比UNION语句少。</font>如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，则尽量使用UNION ALL语句，以提高数据查询的效率。</p></blockquote> <p>举例：查询部门编号&gt;90或邮箱包含a的员工信息</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#方式1</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span> <span class="token operator">OR</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#方式2</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees  <span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees  <span class="token keyword">WHERE</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>举例：查询中国用户中男性的信息以及美国用户中年男性的用户信息</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>cname <span class="token keyword">FROM</span> t_chinamale <span class="token keyword">WHERE</span> csex<span class="token operator">=</span><span class="token string">'男'</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>tname <span class="token keyword">FROM</span> t_usmale <span class="token keyword">WHERE</span> tGender<span class="token operator">=</span><span class="token string">'male'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_5-7种sql-joins的实现"><a href="#_5-7种sql-joins的实现" class="header-anchor">#</a> 5. 7种SQL JOINS的实现</h2> <img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/392/mysqlImages1554979255233.png" alt="1554979255233" style="zoom:80%;"> <h3 id="_5-7-1-代码实现"><a href="#_5-7-1-代码实现" class="header-anchor">#</a> 5.7.1 代码实现</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#中图：内连接 A∩B</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#左上图：左外连接</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#右上图：右外连接</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#左中图：A - A∩B</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#右中图：B-A∩B</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#左下图：满外连接</span>
<span class="token comment"># 左中图 + 右上图  A∪B</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>  <span class="token comment">#没有去重操作，效率高</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#右下图</span>
<span class="token comment">#左中图 + 右中图  A ∪B- A∩B 或者 (A -  A∩B) ∪ （B - A∩B）</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_5-7-2-语法格式小结"><a href="#_5-7-2-语法格式小结" class="header-anchor">#</a> 5.7.2 语法格式小结</h3> <ul><li>左中图</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#实现A -  A∩B</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">left</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>右中图</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#实现B -  A∩B</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">right</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>左下图</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#实现查询结果是A∪B</span>
<span class="token comment">#用左外的A，union 右外的B</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">left</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 等其他子句

<span class="token keyword">union</span> 

<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">right</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 等其他子句<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>右下图</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#实现A∪B -  A∩B  或   (A -  A∩B) ∪ （B - A∩B）</span>
<span class="token comment">#使用左外的 (A -  A∩B)  union 右外的（B - A∩B）</span>
<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">left</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句

<span class="token keyword">union</span>

<span class="token keyword">select</span> 字段列表
<span class="token keyword">from</span> A表 <span class="token keyword">right</span> <span class="token keyword">join</span> B表
<span class="token keyword">on</span> 关联条件
<span class="token keyword">where</span> 从表关联字段 <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">and</span> 等其他子句
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_6-sql99语法新特性"><a href="#_6-sql99语法新特性" class="header-anchor">#</a> 6. SQL99语法新特性</h2> <h3 id="_6-1-自然连接"><a href="#_6-1-自然连接" class="header-anchor">#</a> 6.1 自然连接</h3> <p>SQL99 在 SQL92 的基础上提供了一些特殊语法，比如 <code>NATURAL JOIN</code> 用来表示自然连接。我们可以把自然连接理解为 SQL92 中的等值连接。它会帮你自动查询两张连接表中<code>所有相同的字段</code>，然后进行<code>等值连接</code>。</p> <p>在SQL92标准中：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token operator">AND</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在 SQL99 中你可以写成：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">NATURAL</span> <span class="token keyword">JOIN</span> departments d<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_6-2-using连接"><a href="#_6-2-using连接" class="header-anchor">#</a> 6.2 USING连接</h3> <p>当我们进行连接的时候，SQL99还支持使用 USING 指定数据表里的<code>同名字段</code>进行等值连接。但是只能配合JOIN一起使用。比如：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">USING</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>你能看出与自然连接 NATURAL JOIN 不同的是，USING 指定了具体的相同的字段名称，你需要在 USING 的括号 () 中填入要指定的同名字段。同时使用 <code>JOIN...USING</code> 可以简化 JOIN ON 的等值连接。它与下面的 SQL 查询结果是相同的：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token punctuation">,</span>departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_7-章节小结"><a href="#_7-章节小结" class="header-anchor">#</a> 7. 章节小结</h2> <p>表连接的约束条件可以有三种方式：WHERE, ON, USING</p> <ul><li><p>WHERE：适用于所有关联查询</p></li> <li><p><code>ON</code>：只能和JOIN一起使用，只能写关联条件。虽然关联条件可以并到WHERE中和其他条件一起写，但分开写可读性更好。</p></li> <li><p>USING：只能和JOIN一起使用，而且要求<strong>两个</strong>关联字段在关联表中名称一致，而且只能表示关联字段值相等</p></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#关联条件</span>
<span class="token comment">#把关联条件写在where后面</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments 
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token comment">#把关联条件写在on后面，只能和JOIN一起使用</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments 
<span class="token keyword">ON</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> departments 
<span class="token keyword">ON</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name  
<span class="token keyword">FROM</span> employees <span class="token keyword">JOIN</span> departments 
<span class="token keyword">ON</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token comment">#把关联字段写在using()中，只能和JOIN一起使用</span>
<span class="token comment">#而且两个表中的关联字段必须名称相同，而且只能表示=</span>
<span class="token comment">#查询员工姓名与基本工资</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_title
<span class="token keyword">FROM</span> employees <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> jobs <span class="token keyword">USING</span><span class="token punctuation">(</span>job_id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#n张表关联，需要n-1个关联条件</span>
<span class="token comment">#查询员工姓名，基本工资，部门名称</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_title<span class="token punctuation">,</span>department_name <span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments<span class="token punctuation">,</span>jobs 
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id 
<span class="token operator">AND</span> employees<span class="token punctuation">.</span>job_id <span class="token operator">=</span> jobs<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_title<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> jobs 
<span class="token keyword">ON</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id 
<span class="token operator">AND</span> employees<span class="token punctuation">.</span>job_id <span class="token operator">=</span> jobs<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p><strong>注意：</strong></p> <p>我们要<code>控制连接表的数量</code>。多表连接就相当于嵌套 for 循环一样，非常消耗资源，会让 SQL 查询性能下降得很严重，因此不要连接不必要的表。在许多 DBMS 中，也都会有最大连接表的限制。</p> <blockquote><p>【强制】超过三个表禁止 join。需要 join 的字段，数据类型保持绝对一致；多表关联查询时， 保证被关联的字段需要有索引。</p> <p>说明：即使双表 join 也要注意表索引、SQL 性能。</p> <p>来源：阿里巴巴《Java开发手册》</p></blockquote> <h2 id="附录-常用的-sql-标准有哪些"><a href="#附录-常用的-sql-标准有哪些" class="header-anchor">#</a> 附录：常用的 SQL 标准有哪些</h2> <p>在正式开始讲连接表的种类时，我们首先需要知道 SQL 存在不同版本的标准规范，因为不同规范下的表连接操作是有区别的。</p> <p>SQL 有两个主要的标准，分别是 <code>SQL92</code> 和 <code>SQL99</code>。92 和 99 代表了标准提出的时间，SQL92 就是 92 年提出的标准规范。当然除了 SQL92 和 SQL99 以外，还存在 SQL-86、SQL-89、SQL:2003、SQL:2008、SQL:2011 和 SQL:2016 等其他的标准。</p> <p>这么多标准，到底该学习哪个呢？<strong>实际上最重要的 SQL 标准就是 SQL92 和 SQL99</strong>。一般来说 SQL92 的形式更简单，但是写的 SQL 语句会比较长，可读性较差。而 SQL99 相比于 SQL92 来说，语法更加复杂，但可读性更强。我们从这两个标准发布的页数也能看出，SQL92 的标准有 500 页，而 SQL99 标准超过了 1000 页。实际上从 SQL99 之后，很少有人能掌握所有内容，因为确实太多了。就好比我们使用 Windows、Linux 和 Office 的时候，很少有人能掌握全部内容一样。我们只需要掌握一些核心的功能，满足日常工作的需求即可。</p> <p><strong>SQL92 和 SQL99 是经典的 SQL 标准，也分别叫做 SQL-2 和 SQL-3 标准</strong>。也正是在这两个标准发布之后，SQL 影响力越来越大，甚至超越了数据库领域。现如今 SQL 已经不仅仅是数据库领域的主流语言，还是信息领域中信息处理的主流语言。在图形检索、图像检索以及语音检索中都能看到 SQL 语言的使用。</p> <h2 id="_8-本章练习题"><a href="#_8-本章练习题" class="header-anchor">#</a> 8. 本章练习题</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>【题目<span class="token number">1</span>】
<span class="token comment"># 1.显示所有员工的姓名，部门号和部门名称。</span>

<span class="token comment"># 2.查询90号部门员工的job_id和90号部门的location_id</span>

<span class="token comment"># 3.选择所有有奖金的员工的 last_name , department_name , location_id , city</span>

<span class="token comment"># 4.选择city在Toronto工作的员工的 last_name , job_id , department_id , department_name</span>

<span class="token comment"># 5.查询员工所在的部门名称、部门地址、姓名、工作、工资，其中员工所在部门的部门名称为’Executive’</span>

<span class="token comment"># 6.选择指定员工的姓名，员工号，以及他的管理者的姓名和员工号，结果类似于下面的格式</span>
employees Emp<span class="token comment"># manager Mgr#</span>
kochhar <span class="token number">101</span> king <span class="token number">100</span>

<span class="token comment"># 7.查询哪些部门没有员工</span>

<span class="token comment"># 8. 查询哪个城市没有部门</span>

<span class="token comment"># 9. 查询部门名为 Sales 或 IT 的员工信息</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code>储备：建表操作：
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>t_dept<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
<span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>deptName<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>address<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>t_emp<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
<span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>age<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token identifier"><span class="token punctuation">`</span>deptId<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
empno <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_dept_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>deptId<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token comment">#CONSTRAINT `fk_dept_id` FOREIGN KEY (`deptId`) REFERENCES `t_dept` (`id`)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_dept<span class="token punctuation">(</span>deptName<span class="token punctuation">,</span>address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'华山'</span><span class="token punctuation">,</span><span class="token string">'华山'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_dept<span class="token punctuation">(</span>deptName<span class="token punctuation">,</span>address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'丐帮'</span><span class="token punctuation">,</span><span class="token string">'洛阳'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_dept<span class="token punctuation">(</span>deptName<span class="token punctuation">,</span>address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'峨眉'</span><span class="token punctuation">,</span><span class="token string">'峨眉山'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_dept<span class="token punctuation">(</span>deptName<span class="token punctuation">,</span>address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'武当'</span><span class="token punctuation">,</span><span class="token string">'武当山'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_dept<span class="token punctuation">(</span>deptName<span class="token punctuation">,</span>address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'明教'</span><span class="token punctuation">,</span><span class="token string">'光明顶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_dept<span class="token punctuation">(</span>deptName<span class="token punctuation">,</span>address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'少林'</span><span class="token punctuation">,</span><span class="token string">'少林寺'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'风清扬'</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'岳不群'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100002</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'令狐冲'</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100003</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'洪七公'</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">100004</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'乔峰'</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">100005</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'灭绝师太'</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">100006</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'周芷若'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">100007</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'张三丰'</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">100008</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'张无忌'</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">100009</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> t_emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>age<span class="token punctuation">,</span>deptId<span class="token punctuation">,</span>empno<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'韦小宝'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token number">100010</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

【题目】
<span class="token comment">#1.所有有门派的人员信息</span>
（ A、B两表共有）

<span class="token comment">#2.列出所有用户，并显示其机构信息</span>
（A的全集）

<span class="token comment">#3.列出所有门派</span>
（B的全集）

<span class="token comment">#4.所有不入门派的人员</span>
（A的独有）

<span class="token comment">#5.所有没人入的门派</span>
（B的独有）

<span class="token comment">#6.列出所有人员和机构的对照关系</span>
<span class="token punctuation">(</span>AB全有<span class="token punctuation">)</span>
<span class="token comment">#MySQL Full Join的实现 因为MySQL不支持FULL JOIN,下面是替代方法</span>
<span class="token comment">#left join + union(可去除重复数据)+ right join</span>

<span class="token comment">#7.列出所有没入派的人员和没人入的门派</span>
（A的独有<span class="token operator">+</span>B的独有）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="_9-课后复习"><a href="#_9-课后复习" class="header-anchor">#</a> 9. 课后复习</h2> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 第06章_多表查询</span>

<span class="token comment">/*
SELECT ...,....,....
FROM ....
WHERE .... AND / OR / NOT....
ORDER BY .... (ASC/DESC),....,...
LIMIT ...,...

*/</span>
<span class="token comment">#1. 熟悉常见的几个表</span>
<span class="token keyword">DESC</span> employees<span class="token punctuation">;</span>

<span class="token keyword">DESC</span> departments<span class="token punctuation">;</span>

<span class="token keyword">DESC</span> locations<span class="token punctuation">;</span>

<span class="token comment">#查询员工名为'Abel'的人在哪个城市工作？</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> departments
<span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>


<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> locations 
<span class="token keyword">WHERE</span> location_id <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span>

<span class="token comment">#2. 出现笛卡尔积的错误</span>
<span class="token comment">#错误的原因：缺少了多表的连接条件</span>

<span class="token comment">#错误的实现方式：每个员工都与每个部门匹配了一遍。</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments<span class="token punctuation">;</span>  <span class="token comment">#查询出2889条记录</span>

<span class="token comment">#错误的方式</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> departments<span class="token punctuation">;</span><span class="token comment">#查询出2889条记录</span>


<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>  <span class="token comment">#107条记录</span>

<span class="token keyword">SELECT</span> <span class="token number">2889</span> <span class="token operator">/</span> <span class="token number">107</span>
<span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> departments<span class="token punctuation">;</span> <span class="token comment"># 27条记录</span>


<span class="token comment">#3. 多表查询的正确方式：需要有连接条件</span>

<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments
<span class="token comment">#两个表的连接条件</span>
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token comment">#4. 如果查询语句中出现了多个表中都存在的字段，则必须指明此字段所在的表。</span>
<span class="token keyword">SELECT</span> employees<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>departments<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>employees<span class="token punctuation">.</span>department_id
<span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments
<span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token comment">#建议：从sql优化的角度，建议多表查询时，每个字段前都指明其所在的表。</span>

<span class="token comment">#5. 可以给表起别名，在SELECT和WHERE中使用表的别名。</span>
<span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>dept<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>department_id
<span class="token keyword">FROM</span> employees emp<span class="token punctuation">,</span>departments dept
<span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> dept<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token comment">#如果给表起了别名，一旦在SELECT或WHERE中使用表名的话，则必须使用表的别名，而不能再使用表的原名。</span>
<span class="token comment">#如下的操作是错误的：</span>
<span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>departments<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>department_id
<span class="token keyword">FROM</span> employees emp<span class="token punctuation">,</span>departments dept
<span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>


<span class="token comment">#6. 结论：如果有n个表实现多表的查询，则需要至少n-1个连接条件</span>
<span class="token comment">#练习：查询员工的employee_id,last_name,department_name,city</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>l<span class="token punctuation">.</span>city<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>l<span class="token punctuation">.</span>location_id
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d<span class="token punctuation">,</span>locations l
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token operator">AND</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">/*
演绎式：提出问题1 ---&gt; 解决问题1 ----&gt; 提出问题2 ---&gt; 解决问题2 ....

归纳式：总--分

*/</span>
<span class="token comment">#7. 多表查询的分类</span>
<span class="token comment">/*

角度1：等值连接  vs  非等值连接

角度2：自连接  vs  非自连接

角度3：内连接  vs  外连接

*/</span>

<span class="token comment"># 7.1 等值连接  vs  非等值连接</span>

<span class="token comment">#非等值连接的例子：</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> job_grades<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>j<span class="token punctuation">.</span>grade_level
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>job_grades j
<span class="token comment">#where e.`salary` between j.`lowest_sal` and j.`highest_sal`;</span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">&gt;=</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>lowest_sal<span class="token punctuation">`</span></span> <span class="token operator">AND</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">&lt;=</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>highest_sal<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">#7.2 自连接  vs  非自连接</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>

<span class="token comment">#自连接的例子：</span>
<span class="token comment">#练习：查询员工id,员工姓名及其管理者的id和姓名</span>

<span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name
<span class="token keyword">FROM</span> employees emp <span class="token punctuation">,</span>employees mgr
<span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> mgr<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>


<span class="token comment">#7.3 内连接  vs  外连接</span>

<span class="token comment"># 内连接：合并具有同一列的两个以上的表的行, 结果集中不包含一个表与另一个表不匹配的行</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>  <span class="token comment">#只有106条记录</span>

<span class="token comment"># 外连接：合并具有同一列的两个以上的表的行, 结果集中除了包含一个表与另一个表匹配的行之外，</span>
<span class="token comment">#         还查询到了左表 或 右表中不匹配的行。</span>

<span class="token comment"># 外连接的分类：左外连接、右外连接、满外连接</span>

<span class="token comment"># 左外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回左表中不满足条件的行，这种连接称为左外连接。</span>
<span class="token comment"># 右外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回右表中不满足条件的行，这种连接称为右外连接。</span>

<span class="token comment">#练习：查询所有的员工的last_name,department_name信息 </span>

<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>   <span class="token comment"># 需要使用左外连接</span>

<span class="token comment">#SQL92语法实现内连接：见上，略</span>
<span class="token comment">#SQL92语法实现外连接：使用 +  ----------MySQL不支持SQL92语法中外连接的写法！</span>
<span class="token comment">#不支持：</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#SQL99语法中使用 JOIN ...ON 的方式实现多表的查询。这种方式也能解决外连接的问题。MySQL是支持此种方式的。</span>
<span class="token comment">#SQL99语法如何实现多表的查询。</span>

<span class="token comment">#SQL99语法实现内连接：</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>city
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">JOIN</span> locations l
<span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">#SQL99语法实现外连接：</span>

<span class="token comment">#练习：查询所有的员工的last_name,department_name信息 </span>
<span class="token comment"># 左外连接：</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">#右外连接：</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>


<span class="token comment">#满外连接：mysql不支持FULL OUTER JOIN</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">FULL</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">#8. UNION  和 UNION ALL的使用</span>
<span class="token comment"># UNION：会执行去重操作</span>
<span class="token comment"># UNION ALL:不会执行去重操作</span>
<span class="token comment">#结论：如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，</span>
<span class="token comment">#则尽量使用UNION ALL语句，以提高数据查询的效率。</span>

<span class="token comment">#9. 7种JOIN的实现：</span>

<span class="token comment"># 中图：内连接</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment"># 左上图：左外连接</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment"># 右上图：右外连接</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment"># 左中图：</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment"># 右中图：</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>


<span class="token comment"># 左下图：满外连接</span>
<span class="token comment"># 方式1：左上图 UNION ALL 右中图</span>

<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>


<span class="token comment"># 方式2：左中图 UNION ALL 右上图</span>

<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment"># 右下图：左中图  UNION ALL 右中图</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">#10. SQL99语法的新特性1:自然连接</span>

<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token operator">AND</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment"># NATURAL JOIN : 它会帮你自动查询两张连接表中`所有相同的字段`，然后进行`等值连接`。</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">NATURAL</span> <span class="token keyword">JOIN</span> departments d<span class="token punctuation">;</span>


<span class="token comment">#11. SQL99语法的新特性2:USING</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">USING</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">#拓展：</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_title<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> jobs 
<span class="token keyword">ON</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id 
<span class="token operator">AND</span> employees<span class="token punctuation">.</span>job_id <span class="token operator">=</span> jobs<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br></div></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/myblog/notes/mysql/3.html" class="prev">
          第5章_排序与分页
        </a></span> <span class="next"><a href="/myblog/notes/mysql/5.html">
          第7章_单行函数
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#上一章练习答案" class="sidebar-link reco-side-上一章练习答案" data-v-b57cc07c>上一章练习答案</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#多表查询" class="sidebar-link reco-side-多表查询" data-v-b57cc07c>多表查询</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_1-一个案例引发的多表连接" class="sidebar-link reco-side-_1-一个案例引发的多表连接" data-v-b57cc07c>1. 一个案例引发的多表连接</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_1-1-案例说明" class="sidebar-link reco-side-_1-1-案例说明" data-v-b57cc07c>1.1 案例说明</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_1-2-笛卡尔积-或交叉连接-的理解" class="sidebar-link reco-side-_1-2-笛卡尔积-或交叉连接-的理解" data-v-b57cc07c>1.2 笛卡尔积（或交叉连接）的理解</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_1-3-案例分析与问题解决" class="sidebar-link reco-side-_1-3-案例分析与问题解决" data-v-b57cc07c>1.3 案例分析与问题解决</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_2-多表查询分类讲解" class="sidebar-link reco-side-_2-多表查询分类讲解" data-v-b57cc07c>2. 多表查询分类讲解</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#分类1-等值连接-vs-非等值连接" class="sidebar-link reco-side-分类1-等值连接-vs-非等值连接" data-v-b57cc07c>分类1：等值连接 vs 非等值连接</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#分类2-自连接-vs-非自连接" class="sidebar-link reco-side-分类2-自连接-vs-非自连接" data-v-b57cc07c>分类2：自连接 vs 非自连接</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#分类3-内连接-vs-外连接" class="sidebar-link reco-side-分类3-内连接-vs-外连接" data-v-b57cc07c>分类3：内连接 vs 外连接</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_3-sql99语法实现多表查询" class="sidebar-link reco-side-_3-sql99语法实现多表查询" data-v-b57cc07c>3. SQL99语法实现多表查询</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_3-1-基本语法" class="sidebar-link reco-side-_3-1-基本语法" data-v-b57cc07c>3.1 基本语法</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_3-2-内连接-inner-join-的实现" class="sidebar-link reco-side-_3-2-内连接-inner-join-的实现" data-v-b57cc07c>3.2 内连接(INNER JOIN)的实现</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_3-3-外连接-outer-join-的实现" class="sidebar-link reco-side-_3-3-外连接-outer-join-的实现" data-v-b57cc07c>3.3 外连接(OUTER JOIN)的实现</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_4-union的使用" class="sidebar-link reco-side-_4-union的使用" data-v-b57cc07c>4. UNION的使用</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_5-7种sql-joins的实现" class="sidebar-link reco-side-_5-7种sql-joins的实现" data-v-b57cc07c>5. 7种SQL JOINS的实现</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_5-7-1-代码实现" class="sidebar-link reco-side-_5-7-1-代码实现" data-v-b57cc07c>5.7.1 代码实现</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_5-7-2-语法格式小结" class="sidebar-link reco-side-_5-7-2-语法格式小结" data-v-b57cc07c>5.7.2 语法格式小结</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_6-sql99语法新特性" class="sidebar-link reco-side-_6-sql99语法新特性" data-v-b57cc07c>6. SQL99语法新特性</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_6-1-自然连接" class="sidebar-link reco-side-_6-1-自然连接" data-v-b57cc07c>6.1 自然连接</a></li><li class="level-3" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_6-2-using连接" class="sidebar-link reco-side-_6-2-using连接" data-v-b57cc07c>6.2 USING连接</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_7-章节小结" class="sidebar-link reco-side-_7-章节小结" data-v-b57cc07c>7. 章节小结</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#附录-常用的-sql-标准有哪些" class="sidebar-link reco-side-附录-常用的-sql-标准有哪些" data-v-b57cc07c>附录：常用的 SQL 标准有哪些</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_8-本章练习题" class="sidebar-link reco-side-_8-本章练习题" data-v-b57cc07c>8. 本章练习题</a></li><li class="level-2" data-v-b57cc07c><a href="/myblog/notes/mysql/4.html#_9-课后复习" class="sidebar-link reco-side-_9-课后复习" data-v-b57cc07c>9. 课后复习</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎您的关注！
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div><canvas id="vuepress-canvas-cursor"></canvas><!----></div></div>
    <script src="/myblog/assets/js/app.72a6aef1.js" defer></script><script src="/myblog/assets/js/3.db593f0c.js" defer></script><script src="/myblog/assets/js/1.2743d3a9.js" defer></script><script src="/myblog/assets/js/26.51c97df9.js" defer></script><script src="/myblog/assets/js/9.addaf399.js" defer></script>
  </body>
</html>
